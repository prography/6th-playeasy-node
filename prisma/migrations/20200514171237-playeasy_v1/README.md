# Migration `20200514171237-playeasy_v1`

This migration has been generated by ymink716 at 5/14/2020, 5:12:37 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE `playeasy`.`user` (
`age` int   ,`created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,`email` varchar(191) NOT NULL  ,`id` int NOT NULL  AUTO_INCREMENT,`name` varchar(191)   ,`phone` varchar(191)   ,`push_token` varchar(191)  DEFAULT '' ,`social_type` varchar(191) NOT NULL DEFAULT 'kakao' ,`team_id` int  ,`updated_at` datetime(3) NOT NULL  ,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `playeasy`.`team` (
`description` varchar(191)   ,`id` int NOT NULL  AUTO_INCREMENT,`name` varchar(191) NOT NULL  ,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `playeasy`.`match` (
`awayQuota` int   ,`away_team_id` int  ,`description` varchar(191)   ,`fee` int   ,`homeQuota` int NOT NULL  ,`home_team_id` int NOT NULL ,`id` int NOT NULL  AUTO_INCREMENT,`location` varchar(191) NOT NULL  ,`started_at` datetime(3) NOT NULL  ,`type` ENUM('SOCCKER', 'FUTSAL5', 'FUTSAL6') NOT NULL  ,`writer_id` int NOT NULL ,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE UNIQUE INDEX `user.email` ON `playeasy`.`user`(`email`)

CREATE UNIQUE INDEX `match_home_team_id` ON `playeasy`.`match`(`home_team_id`)

CREATE UNIQUE INDEX `match_away_team_id` ON `playeasy`.`match`(`away_team_id`)

ALTER TABLE `playeasy`.`user` ADD FOREIGN KEY (`team_id`) REFERENCES `playeasy`.`team`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `playeasy`.`match` ADD FOREIGN KEY (`home_team_id`) REFERENCES `playeasy`.`team`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `playeasy`.`match` ADD FOREIGN KEY (`away_team_id`) REFERENCES `playeasy`.`team`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `playeasy`.`match` ADD FOREIGN KEY (`writer_id`) REFERENCES `playeasy`.`user`(`id`) ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200514171237-playeasy_v1
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,56 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource mysql {
+  url      = env("DB_URL")
+  provider = "mysql"
+}
+
+model User {
+  id          Int       @default(autoincrement()) @id
+  name        String?   
+  age         Int?      
+  email       String    @unique
+  socialType  String    @default("kakao") @map("social_type")
+  phone       String?   
+  pushToken   String?   @default("") @map("push_token")
+  createdAt   DateTime  @default(now()) @map("created_at")
+  updatedAt   DateTime  @updatedAt() @map("updated_at") 
+  team        Team?     @relation(fields: [teamId], references: [id])
+  teamId      Int?      @map("team_id")
+
+  @@map("user")
+}
+
+model Team {
+  id          Int     @default(autoincrement()) @id
+  name        String   
+  description String?
+  home        Match   @relation("home")
+  away        Match   @relation("away")
+  @@map("team")   
+}
+
+model Match {
+  id            Int         @default(autoincrement()) @id
+  type          MatchType 
+  description   String?
+  homeTeam      Team        @relation("home", fields: [homeTeamId], references: [id]) 
+  homeTeamId    Int         @map("home_team_id")
+  awayTeam      Team?       @relation("away", fields: [awayTeamId], references: [id])
+  awayTeamId    Int?        @map("away_team_id")
+  location      String          
+  startedAt     DateTime    @map("started_at")
+  homeQuota     Int
+  awayQuota     Int?
+  fee           Int?
+  writer        User        @relation(fields: [writerId], references: [id])
+  writerId      Int         @map("writer_id")
+
+  @@map("match")
+}
+
+enum MatchType {
+  SOCCKER FUTSAL5 FUTSAL6
+}
```


